WITH temp AS (
    SELECT a.user_id, b.action
    FROM Signups a
    LEFT JOIN Confirmations b ON a.user_id = b.user_id
)
SELECT
    t1.user_id,
    ROUND(SUM(CASE WHEN t1.action = 'timeout' THEN 1 ELSE 0 END) * 1.0 / COUNT(*),2) AS confirmation_rate
FROM temp t1
GROUP BY t1.user_id 

--or

WITH cte AS (
SELECT s.user_id AS user_id, COUNT(*) tot_cnt,
SUM(CASE WHEN action = "confirmed" THEN 1 ELSE 0 END) AS con_cnt
FROM Signups s LEFT JOIN Confirmations c
ON s.user_id = c.user_id
GROUP BY s.user_id)

SELECT user_id, ROUND(con_cnt / tot_cnt,2) AS confirmation_rate
FROM cte


--or

select a.user_id, round(sum(case when b.action='confirmed' then 1 else 0 end)/count(*), 2) as confirmation_rate from Signups a left join confirmations b on a.user_id=b.user_id
group by a.user_id
