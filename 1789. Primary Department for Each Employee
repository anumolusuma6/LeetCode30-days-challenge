SELECT
    e.employee_id,
    CASE
        WHEN COUNT(e.department_id) > 1 THEN
            (SELECT department_id FROM employee WHERE employee_id = e.employee_id AND primary_flag = 'Y')
        WHEN COUNT(e.department_id) = 1 THEN 
            MAX(e.department_id)
        ELSE
            0
    END AS department_id
FROM
    employee e
GROUP BY
    e.employee_id
    HAVING MAX(primary_flag = 'Y') = 1 OR COUNT(department_id) = 1;

--or

select employee_id, department_id
from Employee
where primary_flag = 'Y' or employee_id in (
select employee_id from employee group by employee_id having count(department_id) = 1)
