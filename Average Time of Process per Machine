select l1.machine_id, round(avg(l2.timestamp-l1.timestamp), 3) as processing_time from Activity l1 inner join Activity l2 on l1.machine_id=l2.machine_id and l1.activity_type='start'and l2.activity_type='end'
group by machine_id

--or

SELECT 
    machine_id,
    ROUND(SUM(CASE WHEN activity_type='start' THEN timestamp*-1 ELSE timestamp END)*1.0
    / (SELECT COUNT(DISTINCT process_id)),3) AS processing_time
FROM 
    Activity
GROUP BY machine_id
