SELECT ROUND(
   SUM(CASE WHEN DATEDIFF(order_date, customer_pref_delivery_date) = 0 THEN 1 ELSE 0 END) *100 / COUNT(customer_id), 2) AS immediate_percentage
FROM (
    SELECT
        delivery_id,
        customer_pref_delivery_date,
        RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rnk,
        customer_id,
        order_date
    FROM
        Delivery
) AS ranked_orders
WHERE rnk = 1;
